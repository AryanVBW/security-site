{"schema_version": "1.6.1", "id": "CVE-2021-42340", "summary": "DoS via memory leak with WebSocket connections", "details": "The fix for bug 63362 present in Apache Tomcat 10.1.0-M1 to 10.1.0-M5, 10.0.0-M1 to 10.0.11, 9.0.40 to 9.0.53 and 8.5.60 to 8.5.71 introduced a memory leak. The object introduced to collect metrics for HTTP upgrade connections was not released for WebSocket connections once the connection was closed. This created a memory leak that, over time, could lead to a denial of service via an OutOfMemoryError.", "affected": [{"ranges": [{"type": "SEMVER", "events": [{"introduced": "Apache Tomcat 10 10.0.0-M10 to 10.0.11"}, {"last_affected": "Apache Tomcat 10 10.0.0-M10 to 10.0.11"}]}, {"type": "SEMVER", "events": [{"introduced": "Apache Tomcat 10 10.1.0-M1 to 10.1.0-M5"}, {"last_affected": "Apache Tomcat 10 10.1.0-M1 to 10.1.0-M5"}]}, {"type": "SEMVER", "events": [{"introduced": "Apache Tomcat 9 9.0.40 to 9.0.53"}, {"last_affected": "Apache Tomcat 9 9.0.40 to 9.0.53"}]}, {"type": "SEMVER", "events": [{"introduced": "Apache Tomcat 8 8.5.60 to 8.5.71"}, {"last_affected": "Apache Tomcat 8 8.5.60 to 8.5.71"}]}]}], "references": [{"type": "ADVISORY", "url": "https://lists.apache.org/thread.html/r83a35be60f06aca2065f188ee542b9099695d57ced2e70e0885f905c%40%3Cannounce.tomcat.apache.org%3E"}]}