{"schema_version": "1.6.1", "id": "CVE-2021-45046", "summary": "Apache Log4j2 Thread Context Lookup Pattern vulnerable to remote code execution in certain non-default configurations", "details": "It was found that the fix to address CVE-2021-44228 in Apache Log4j 2.15.0 was incomplete in certain non-default configurations. When the logging configuration uses a non-default Pattern Layout with a Context Lookup (for example, $${ctx:loginId}), attackers with control over Thread Context Map (MDC) input data can craft malicious input data using a JNDI Lookup pattern, resulting in an information leak and remote code execution in some environments and local code execution in all environments; remote code execution has been demonstrated in operating systems using glibc with the libnss_resolve provider, glibc versions before 2.28, musl, and systemd-resolvd.\n\nLog4j 2.16.0 (Java 8), 2.12.2 (Java 7), and 2.3.1 (Java 6) fix this issue by removing support for message lookup patterns and disabling JNDI functionality by default.\n\n", "affected": [{"ranges": [{"type": "SEMVER", "events": [{"introduced": "log4j-core"}, {"fixed": "2.16.0"}]}]}], "references": [{"type": "ADVISORY", "url": "https://logging.apache.org/log4j/2.x/security.html"}, {"type": "WEB", "url": "https://www.cve.org/CVERecord?id=CVE-2021-44228"}]}