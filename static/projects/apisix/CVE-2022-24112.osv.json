{"schema_version": "1.6.1", "id": "CVE-2022-24112", "summary": "apisix/batch-requests plugin allows overwriting the X-REAL-IP header", "details": "An attacker can abuse the batch-requests plugin to send requests to bypass the IP restriction of Admin API.\nA default configuration of Apache APISIX (with default API key) is vulnerable to remote code execution.\nWhen the admin key was changed or the port of Admin API was changed to a port different from the data panel, the impact is lower. But there is still a risk to bypass the IP restriction of Apache APISIX's data panel.\n\nThere is a check in the batch-requests plugin which overrides the client IP with its real remote IP. But due to a bug in the code, this check can be bypassed.", "affected": [{"ranges": [{"type": "SEMVER", "events": [{"introduced": "Apache APISIX 2.12"}, {"fixed": "2.12.1"}]}, {"type": "SEMVER", "events": [{"introduced": "Apache APISIX 2.10"}, {"fixed": "2.10.4"}]}, {"type": "SEMVER", "events": [{"introduced": "1.3"}, {"fixed": "Apache APISIX 1*"}]}]}], "references": [{"type": "ADVISORY", "url": "https://lists.apache.org/thread/lcdqywz8zy94mdysk7p3gfdgn51jmt94"}]}